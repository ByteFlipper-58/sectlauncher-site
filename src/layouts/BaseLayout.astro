---
import "../styles/global.css";
const { title = "SectLauncher", description = "Кроссплатформенный лаунчер Minecraft" } = Astro.props;
// Управление индексацией: по умолчанию запрещаем, включается только через PUBLIC_ALLOW_INDEXING=true
const allowIndexing = String(import.meta.env.PUBLIC_ALLOW_INDEXING).toLowerCase() === 'true';
const currentLocale = Astro.currentLocale ?? 'ru';
const ogLocale = currentLocale === 'ru' ? 'ru_RU' : 'en_US';
const ogLocaleAlt = currentLocale === 'ru' ? 'en_US' : 'ru_RU';
const baseHref = Astro.site?.href ?? 'https://sectlauncher.byteflipper.com/';
function toAbsoluteUrl(pathOrUrl: string | undefined): string | undefined {
  if (!pathOrUrl) return undefined;
  if (/^https?:\/\//i.test(pathOrUrl)) return pathOrUrl;
  const base = baseHref.endsWith('/') ? baseHref.slice(0, -1) : baseHref;
  const path = pathOrUrl.startsWith('/') ? pathOrUrl : `/${pathOrUrl}`;
  return `${base}${path}`;
}
const defaultOgImage = toAbsoluteUrl('/web-app-manifest-512x512.png');
---
<html lang={Astro.currentLocale ?? 'ru'} class="bg-neutral-950 text-neutral-100">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>{title}</title>
    <meta name="description" content={description} />
    <meta name="robots" content={allowIndexing ? 'index, follow' : 'noindex, nofollow'} />
    <meta property="og:title" content={title} />
    <meta property="og:description" content={description} />
    <meta property="og:site_name" content="SectLauncher" />
    <meta property="og:locale" content={ogLocale} />
    <meta property="og:image" content={defaultOgImage} />
    <meta property="og:locale:alternate" content={ogLocaleAlt} />
    <meta name="twitter:card" content="summary_large_image" />
    <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96" />
    <link rel="icon" type="image/svg+xml" href="/favicon.svg" />
    <link rel="shortcut icon" href="/favicon.ico" />
    <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
    <meta name="apple-mobile-web-app-title" content="SectLauncher" />
    <link rel="manifest" href="/site.webmanifest" />
    <style>
      .hero-bg{background:radial-gradient(1200px 600px at 20% 0%, rgba(46,204,113,.25), transparent 60%),radial-gradient(900px 500px at 80% 10%, rgba(241,196,15,.18), transparent 60%)}
    </style>
    <slot name="head" />
    <script is:inline>
      try { localStorage.setItem('pref_locale', (Astro.currentLocale ?? 'ru')); } catch {}
    </script>
  </head>
  <body class="antialiased min-h-screen flex flex-col">
    <slot name="header" />
    <main class="flex-1"><slot /></main>
    <slot name="footer" />
    <script type="module">import '../scripts/firebase.ts';</script>
  </body>
</html>


